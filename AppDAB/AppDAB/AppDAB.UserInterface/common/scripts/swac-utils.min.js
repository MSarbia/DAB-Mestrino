/* Version 1.0.0, copyright (C) 2017, Siemens AG. All Rights Reserved. */
var SWAC=SWAC||{};SWAC.Utils=SWAC.Utils||{},SWAC.Utils.Manifest=function(){function a(a){var b,c=[];if("object"==typeof a||"function"==typeof a)for(b in a)hasOwnProperty.call(a,b)&&c.push(b);return c}function b(b,c){var d="";if("object"==typeof c&&"boolean"==typeof c.useFunctions&&c.useFunctions){if(b.API&&b.API.methods&&(b.API.functions=b.API.methods,delete b.API.methods),b.interfaces&&a(b.interfaces).length>0)for(d in b.interfaces)b.interfaces[d].methods&&(b.interfaces[d].functions=b.interfaces[d].methods,delete b.interfaces[d].methods)}else if(b.API&&b.API.functions&&(b.API.methods=b.API.functions,delete b.API.functions),b.interfaces&&a(b.interfaces).length>0)for(d in b.interfaces)b.interfaces[d].functions&&(b.interfaces[d].methods=b.interfaces[d].functions,delete b.interfaces[d].functions)}function c(a,c){return{ver:a,fromPrevious:function(c,d){return c.coreVersion||(c.coreVersion=a),b(c,d),{converted:!0,manifest:c}},toPrevious:function(a,d){return a.coreVersion||(a.coreVersion=c),b(a,d),{converted:!0,manifest:a}}}}function d(a,b){var c;for(a=a.ver.split(".").map(function(a){return parseInt(a)}),b=b.ver.split(".").map(function(a){return parseInt(a)}),c=0;3>c;c++){if(a[c]<b[c])return!0;if(a[c]>b[c])return!1}return!0}function e(a,b,c){var e=/^(\d+\.\d+\.\d+)(?:-([0-9A-Za-z-]+(?:\.[0-9A-Za-z-]+)*))?(?:\+([0-9A-Za-z-]+(?:\.[0-9A-Za-z-]+)*))?$/,g=f.versions.slice(0).sort(function(a,b){return!d(a,b)}).reverse();if("string"!=typeof b||!e.test(b))return{converted:!1,error:"SWAC.Utils.Manifest.convert: Wrong output version format"};var h="string"==typeof a?JSON.parse(a):JSON.parse(JSON.stringify(a)),i=function(a,b){var c={},e=-1,f=-1;if(a===b)return c;var h=function(a,b){var c;for(c=0;c<a.length;c++)if(d(a[c],b))return c;return-1};return e=h(g,{ver:a}),f=h(g,{ver:b}),c={fromIdx:e,toIdx:f}},j="";if("string"==typeof h.coreVersion&&e.test(h.coreVersion)?j=h.coreVersion:"string"==typeof h.mver&&e.test(h.mver)&&"undefined"!=typeof h.swac&&(j=h.mver),j.length>0){var k=i(j,b),l="fromPrevious",m=-1;if(h={converted:!0,manifest:h},k.fromIdx!==k.toIdx&&-1!==k.fromIdx&&-1!==k.toIdx){k.toIdx>k.fromIdx?(l="toPrevious",m=1,k.toIdx--):k.fromIdx--;for(var n=k.fromIdx;(g[n]&&g[n][l]&&(h=g[n][l].call(this,h.manifest,c)),h.converted)&&n!==k.toIdx;n+=m);}return h}return{converted:!1,error:"SWAC.Utils.Manifest.convert: unsupported manifest format"}}var f={};return f={convert:e,versions:[]},f.versions.push({ver:"1.0.0"}),f.versions.push(c("1.0.1","1.0.0")),f.versions.push(c("1.0.2","1.0.1")),f.versions.push({ver:"1.2.0",fromPrevious:function(b){var c=0,d=["px","cm","mm","in","em","pt"],e="",f=function(a){return"string"==typeof a?{type:a}:a},g={},h=function(a){g.swac.metadata=g.swac.metadata||{},g.swac.metadata.x_custom={};for(var b in a)a.hasOwnProperty(b)&&(g.swac.metadata.x_custom[b]=a[b])},i=function(a){var b={},c=0,d=0,e={},g={},h={},i="methods";if("[object Array]"===Object.prototype.toString.call(a.functions)&&(i="functions"),"[object Array]"===Object.prototype.toString.call(a[i])&&a[i].length>0)for(b.methods={},c=0;c<a[i].length;c++){if(g={},a[i][c][3].length>0)for(d=0;d<a[i][c][3].length;d++)g[a[i][c][3][d][0]]=f(a[i][c][3][d][1]);e={description:a[i][c][1],"return":f(a[i][c][2]),parameters:g},b.methods[a[i][c][0]]=e}if("[object Array]"===Object.prototype.toString.call(a.events)&&a.events.length>0)for(b.events={},c=0;c<a.events.length;c++){if(h={},a.events[c][2].length>0)for(d=0;d<a.events[c][2].length;d++)h[a.events[c][2][d][0]]=f(a.events[c][2][d][1]);e={description:a.events[c][1],arguments:h},b.events[a.events[c][0]]=e}return b};if(g={mver:"1.2.0",swac:{identity:{name:b.name,version:b.version,displayname:b.name+" "+b.version,type:b.componentType}}},delete b.name,delete b.version,delete b.componentType,b.coreVersion&&(g.swac.environment={prerequisites:{version:b.coreVersion}}),delete b.coreVersion,b.flavor&&("UI"===b.flavor||"UILess"===b.flavor)&&(g.swac.identity.flavor=b.flavor,delete b.flavor),b.prerequisites){if(b.prerequisites.services&&"[object Array]"===Object.prototype.toString.call(b.prerequisites.services)){if(b.prerequisites.services.length>0)for(g.swac.environment.prerequisites.services={},c=0;c<b.prerequisites.services.length;c++)g.swac.environment.prerequisites.services[b.prerequisites.services[c]]={};delete b.prerequisites.services}if(b.prerequisites.renderingSpace&&"object"==typeof b.prerequisites.renderingSpace){if(g.swac.environment.prerequisites.renderingspace={},"string"==typeof b.prerequisites.renderingSpace.width&&(g.swac.environment.prerequisites.renderingspace.minwidth=parseInt(b.prerequisites.renderingSpace.width),b.prerequisites.renderingSpace.width.length>2&&(e=b.prerequisites.renderingSpace.width.substr(-2)),delete b.prerequisites.renderingSpace.width),"string"==typeof b.prerequisites.renderingSpace.height&&(g.swac.environment.prerequisites.renderingspace.minheight=parseInt(b.prerequisites.renderingSpace.height),0===e.length&&b.prerequisites.renderingSpace.height.length>2&&(e=b.prerequisites.renderingSpace.height.substr(-2)),delete b.prerequisites.renderingSpace.height),0!==e.length)for(e=e.toLowerCase(),c=0;c<d.length;c++)if(e===d[c]){g.swac.environment.prerequisites.renderingspace.unit=e;break}0===a(b.prerequisites.renderingSpace).length&&delete b.prerequisites.renderingSpace}0===a(b.prerequisites).length&&delete b.prerequisites}if((b.homepage||b.author||b.keywords||b.description)&&(g.swac.metadata={},"string"==typeof b.homepage&&(g.swac.metadata.homepage=b.homepage,delete b.homepage),"string"==typeof b.description&&(g.swac.metadata.description=b.description,delete b.description),b.keywords&&"[object Array]"===Object.prototype.toString.call(b.keywords)&&(g.swac.metadata.keywords=b.keywords,delete b.keywords),"object"==typeof b.author&&(g.swac.metadata.author=[{}],"string"==typeof b.author.name&&(g.swac.metadata.author[0].name=b.author.name,delete b.author.name),"string"==typeof b.author.mail&&(g.swac.metadata.author[0].email=b.author.mail,delete b.author.mail),0===a(b.author).length&&delete b.author)),"string"==typeof b.source&&(g.swac.identity.source=b.source,delete b.source),"object"==typeof b.customTypes&&(g.swac.types=b.customTypes,delete b.customTypes),b.API||b.interfaces||b.DPC&&b.DPC.length>0){if(g.swac.contracts={},"object"==typeof b.API&&(g.swac.contracts.api=i(b.API),"[object Array]"===Object.prototype.toString.call(b.API.methods)&&delete b.API.methods,"[object Array]"===Object.prototype.toString.call(b.API.functions)&&delete b.API.functions,"[object Array]"===Object.prototype.toString.call(b.API.events)&&delete b.API.events,0===a(b.API).length&&delete b.API),"object"==typeof b.interfaces){g.swac.contracts.interfaces={};for(var j in b.interfaces)b.interfaces.hasOwnProperty(j)&&(g.swac.contracts.interfaces[j]=i(b.interfaces[j]),"[object Array]"===Object.prototype.toString.call(b.interfaces[j].methods)&&delete b.interfaces[j].methods,"[object Array]"===Object.prototype.toString.call(b.interfaces[j].functions)&&delete b.interfaces[j].functions,"[object Array]"===Object.prototype.toString.call(b.interfaces[j].events)&&delete b.interfaces[j].events,0===a(b.interfaces[j]).length&&delete b.interfaces[j]);0===a(b.interfaces).length&&delete b.interfaces}b.DPC&&(b.DPC.length>0&&(g.swac.contracts.dpc=function k(a){var b={},c=0;for(c=0;c<a.length;c++)4===a[c].length?(b[a[c][0]]=f(a[c][3]),b[a[c][0]].description=a[c][1],b[a[c][0]].permission=a[c][2].toLowerCase(),b[a[c][0]].node="data"):(b[a[c][0]]={children:k(a[c][1])},b[a[c][0]].node="structures");return b}(b.DPC)),delete b.DPC)}return a(b).length>0&&h(b,g),{converted:!0,manifest:g}},toPrevious:function(a,b){a=a.swac;var c=function(a){return a.type?a.type:{$ref:a.$ref}},d=function(a){var d,e={},f="",g=[],h="",i="",j=[],k="boolean"==typeof b.useFunctions&&b.useFunctions?"functions":"methods";if("object"==typeof a.methods){e[k]=[];for(f in a.methods)if(a.methods.hasOwnProperty(f)){g=[];for(h in a.methods[f].parameters)a.methods[f].parameters.hasOwnProperty(h)&&g.push([h,c(a.methods[f].parameters[h])]);e[k].push([f,a.methods[f].description||"",c(a.methods[f].return),g])}}if("object"==typeof a.events){e.events=[];for(i in a.events)if(a.events.hasOwnProperty(i)){j=[];for(d in a.events[i].arguments)a.events[i].arguments.hasOwnProperty(d)&&j.push([d,c(a.events[i].arguments[d])]);e.events.push([i,a.events[i].description||"",j])}}return e},e={name:a.identity.name,version:a.identity.version,componentType:a.identity.type},f="";if("string"==typeof a.identity.source&&(e.source=a.identity.source),("UI"===a.identity.flavor||"UILess"===a.identity.flavor)&&(e.flavor=a.identity.flavor),a.metadata&&("string"==typeof a.metadata.description&&(e.description=a.metadata.description),"string"==typeof a.metadata.homepage&&(e.homepage=a.metadata.homepage),a.metadata.keywords&&"[object Array]"===Object.prototype.toString.call(a.metadata.keywords)&&(e.keywords=a.metadata.keywords),"[object Array]"===Object.prototype.toString.call(a.metadata.author)&&a.metadata.author.length>0&&(e.author={},"string"==typeof a.metadata.author[0].name&&(e.author.name=a.metadata.author[0].name),"string"==typeof a.metadata.author[0].email&&(e.author.mail=a.metadata.author[0].email))),"string"==typeof a.identity.source&&(e.source=a.identity.source),"object"==typeof a.types&&(e.customTypes=a.types),"object"==typeof a.contracts){if("object"==typeof a.contracts.api&&(e.API=d(a.contracts.api)),"object"==typeof a.contracts.interfaces){e.interfaces={};for(var g in a.contracts.interfaces)a.contracts.interfaces.hasOwnProperty(g)&&(e.interfaces[g]=d(a.contracts.interfaces[g]))}a.contracts.dpc&&(e.DPC=function i(a){var b="",d=[];for(b in a)a.hasOwnProperty(b)&&("data"===a[b].node?d.push([b,a[b].description||"",a[b].permission.toUpperCase(),c(a[b])]):d.push([b,i(a[b].children)]));return d}(a.contracts.dpc))}if("object"==typeof a.environment){if("object"==typeof a.environment.prerequisites){if(e.prerequisites={},a.environment.prerequisites.services){e.prerequisites.services=[];for(var h in a.environment.prerequisites.services)a.environment.prerequisites.services.hasOwnProperty(h)&&e.prerequisites.services.push(h)}a.environment.prerequisites.renderingspace&&(e.prerequisites.renderingSpace={},a.environment.prerequisites.renderingspace.unit&&(f=a.environment.prerequisites.renderingspace.unit),a.environment.prerequisites.renderingspace.minwidth&&(e.prerequisites.renderingSpace.width=""+a.environment.prerequisites.renderingspace.minwidth+f),a.environment.prerequisites.renderingspace.minheight&&(e.prerequisites.renderingSpace.height=""+a.environment.prerequisites.renderingspace.minheight+f)),a.environment.prerequisites.version&&(e.coreVersion=a.environment.prerequisites.version)}}else e.coreVersion="1.0.2";return{converted:!0,manifest:e}}}),f}();